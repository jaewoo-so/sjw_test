---
layout: post
title:  ""
date:   2023-01-01
#tags: [project]
---

- 일반적인 포트폴리오를 통해 자산관리 및 수익을 얻으려고 할때, 종목의 수익률을 최대화 하려고 한다. 
- 하지만 금융 상품에 대해서 손익통산 및 이월공제가 가능하다면, 보유 포트폴리오 종목의 주가하락에 따른 손실을 기회로 포착하여 Loss를 실현함으로써  절세효과를 극대화하는 전략이 사용 가능해진다.  
이를 Tax-loss harvesting(TLH)라고 부르고, 포트폴리오 수익률 증대전략이 아닌 절세효과로 인해 알파수익을 추구하는 전략이다. 

- TLH는 취득원가 미만으로 떨어진 주식을 매도하여 손실을 확정하고 이익실현 가능한 주식
   을 동시에 매도하여  납부세금을 절약하는 매매전략 (loss,gain 상쇄)


본 프로젝트는 주식 및 ETF의 포트폴리오 

샘플 알고리즘 

기술적 분석



- PPO 
- LSTM 
- Deep Q-Learning 


강화학습의 리턴은 다음과 같이 설계하였다. 


$$return = 10$$


Supervised learning loss design

@@ loss 디자인 

Reinforcement Learning Return design 

state 
action 
reward 

@@ loss 디자인


위와 같은 결과가 있지만, 실제 서비스에 적용하기는 어렵다는 결론을 내렸다. 그 이유는 사용자 입장에서 Black box 모델의 시뮬레이션 결과를 근거로 모델에 기반한 투자를 선택하기 쉽지 않기 때문이다. 
 따라서 매우 단순한 loss-cut 전략의 파라미터를 최적화 하는데 ML모델을 사용해 보았다. 

 먼저 다음의 전제들을 가정했다. 

 1. 주식 트랜드나 가격 예측은 불가능하다. 
 2. 주식 트랜드나 가격 예측은 어느정도는 가능하다. 


1번의 경우 ML모델로 특정 패턴에 최적화된 loss-cut 파라미터를 찾아낼 수 가 없다. 따라서 랜덤 확률 프로세스를 사용하여, 

2번의 경우는 reward 



#설계 근거 
---
 
 ## Why design $\text{Action Space} = \{ Buy,Sell \}$?

 일반적인 트레이딩이 아닌, tax 최적화를 위해, 이익실현 연기,
 손해 확정 등의 액션도 가능하다. 하지만 간단하게 하기 위해 임의로 
 action space를 단순화 시켰다. 

## Why only single asset?

각 주가의 트랜드에 맞게 
따라서 최적의 전략을 추천해주는 상위 모델이 따로 있다. 
따라서 본 프로젝트에서는 많이 보이는 패턴의 종목에 최적화된 모델을 만드는 것이 우선적인 목표이다. 그리고 종목에 최적화된 모델이 완성 되면, 각 모델의 output을 reward로 하는 종목 추천 모델 훈련에 사용한다. 










#TLH 평가 방법
---
$$Value_{TLH} = min(G,L)(\tau_{t_1} - \tau_{t_2} + ) $$




#Conclusion 
---

기존 기술적 분석 기반의 방법론들은 높은 수익률 생기는 주가의 패턴이 확실했다. 

Machine Learning의 학습 기반 모델의 경우는 많은 주가 패턴 및 트랜드에서 기술적 분석 기반의 방법론들 보다는 수익률의 편차가 작았다. 

@@ 상승, 박스, 하락 각각의 경우에 대한 기술적 분석 기반 방법 vs RL기반 , LSTM 기반 넣기 


특히 Deep Learning 기반의 경우는 전처리가 중요하게 보인다. 

@@ 스무딩 전 후 차이 예시 


# 2. RL 기반 
---

## 2. Return 모델링


## 3. 시뮬레이션 결과 

## 3. RNN 기반 
---

## 4. F



LSTM 


- 전통적인 방법 vs RL
- 종목에 따른 최적 방법론이 다르다. 
- 종목 구성 후 
- 확률 과정 vs ML Base
  - Shift 





** 어떻게 no-free lnuch 



